// Navigation

.main-navigation {

	color: var(--primary-nav--color-text);
	font-size: var(--primary-nav--font-size);
	margin-top: var(--global--spacing-vertical);

	// Menu wrapper
	& > div {
		display: none;
	}

	// Mobile menu toggle
	#toggle-menu {
		display: inline-block;
		margin: 0;
	}

	// Checkbox hack
	#toggle:checked ~ div:not(.woocommerce-menu-container) {
		display: block;
	}

	#toggle:focus + #toggle-menu {
		background-color: var(--primary-nav--color-link-hover);
		outline: inherit;
		text-decoration: underline;
	}

	.dropdown-icon.close {
		display: none;
	}

	#toggle:checked + #toggle-menu {
		.open {
			display: none;
		}

		.close {
			display: inline;
		}
	}

	@include media(mobile) {

		display: flex;
		justify-content: var(--primary-nav--justify-content);

		& > div {
			display: inline-block;
		}

		#toggle-menu {
			display: none;
		}

		// Hide sub-sub-menus
		& > div > ul > li > ul {
			display: none;
		}
	}

	// Menu list wrapper
	& > div > ul {
		display: flex;
		flex-wrap: wrap;
		list-style: none;
		margin: 0;
		max-width: none;
		padding-left: 0;
		position: relative;

		ul {
			padding-left: 0;
		}

		li {
			display: block;
			position: relative;
			width: 100%;
			color: var(--primary-nav--color-link);
			z-index: 1;

			&:hover,
			&:focus-within {
				cursor: pointer;
				z-index: 99999;
			}

			&:hover,
			&:focus {
				color: var(--primary-nav--color-link-hover);
			}

			&:focus-within a {
			//	outline: none;
			}

			@include media(mobile) {
				display: inherit;
				width: inherit;

				/* Submenu display */
				&:hover > ul,
				&:focus-within > ul,
				& ul:hover,
				& ul:focus {
					visibility: visible;
					opacity: 1;
					display: block;
				}
			}
		}

		& > li {

			@include media(mobile) {
				& > a {
					@include crop-text(var(--global--line-height-base));
				}

				&:first-of-type > a {
					padding-left: 0;
				}

				&:last-of-type > a {
					padding-right: 0;
				}
			}
		}

		/* Sub-menus Flyout */
		& > li > .sub-menu {
			margin: 0;
			position: relative;

			@include media(mobile) {
				background: var(--global--color-background);
				box-shadow: var(--global--elevation-4);
				left: 0;
				top: 100%;
				min-width: max-content;
				opacity: 0;
				position: absolute;
				transition: all 0.5s ease;
				visibility: hidden;
			}

			.sub-menu {
				width: 100%;
			}
		}
	}

	// Menu Link
	.menu-item {
		color: var(--primary-nav--color-link);

		&:hover {
			color: var(--primary-nav--color-link-hover);
		}
	}

	a {
		color: currentColor;
		display: block;
		font-family: var(--primary-nav--font-family);
		font-weight: var(--primary-nav--font-weight);
		padding: calc(0.5 * var(--primary-nav--padding)) 0;

		@include media(mobile) {
			padding: var(--primary-nav--padding);
		}

		&:hover,
		&:link,
		&:visited {
			color: currentColor;
		}
	}

	// Sub-menu depth indicators
	.sub-menu {

		list-style: none;
		margin-left: 0;
		/* Reset the counter for each UL */
		counter-reset: nested-list;

		.menu-item a {

			padding-top: calc(0.5 * var(--primary-nav--padding));
			padding-bottom: calc(0.5 * var(--primary-nav--padding));

			&::before {
				/* Increment the dashes */
				counter-increment: nested-list;
				/* Insert dashes with spaces in between */
				content: "\2013\00a0" counters( nested-list, "\2013\00a0", none );
			}
		}
	}

	// Show top-level sub-menu indicators above mobile-breakpoint-only
	@include media(mobile) {
		.menu-item-has-children {

			> a {
				padding-right: 0;
			}

			> .svg-icon {
				display: inline-block;
				height: 100%;
				fill: currentColor;
				margin-right: var(--primary-nav--padding);
			}
		}
	}

	.hide-visually {
		position: absolute !important;
		clip: rect(1px, 1px, 1px, 1px);
		padding:0 !important;
		border:0 !important;
		height: 1px !important;
		width: 1px !important;
		overflow: hidden;
	}
}
